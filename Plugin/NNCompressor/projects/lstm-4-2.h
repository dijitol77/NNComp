/**
 * Autogenerated header file for lstm-4-2
 * neural network model parameters.
 * 
 * Created on: 03/10/2022 at: 10:19
 * By Michael Holmes
*/

#pragma once
#include "layers.h"

template<typename T>
class Lstm_4_2
{
public:
	const static int h = 4;
	const static int d = 1;
	const static int layers = 2;

	FccLayer<T, h, d> f;
	LstmLayer<T, h, d> l0;
	LstmLayer<T, h, h> l1;

	Lstm_4_2() {
		l0.Wii << -1.1237175 ,-0.5936374 , 1.6117938 , 0.23056762;
		l0.Wif << 3.031693  ,0.54237497,0.32304212,0.4318755 ;
		l0.Wig << -1.4807696 , 0.16132143, 1.7900767 , 0.8807571 ;
		l0.Wio << -0.30840808,-0.23793627, 1.9955027 , 1.7027621 ;

		l0.Whi << -0.7109862 ,-1.2913976 ,-0.10162783, 1.2568669 ,-0.81608427,-0.6068385 ,  0.09933643, 0.2616471 ,-0.560526  ,-0.8968833 ,-1.4345368 ,-0.24702732,  0.41427317, 0.1583764 ,-0.34709388,-0.19475289;
		l0.Whf <<  0.97960514, 0.7496263 ,-0.3903761 ,-0.67035943,-0.2771839 ,-0.30638954,  0.3985284 , 0.306479  , 0.26104704,-0.25888655, 0.7036177 ,-0.08136726,  0.26926953,-0.4686315 , 0.3524394 , 0.25560346;
		l0.Whg << -0.16069123, 0.15992786, 0.78488255, 0.64959043, 0.38055444, 0.59391314,  0.28194055,-0.5404069 , 0.26570606,-0.31355193,-0.31724542, 0.04829498, -0.13816972, 0.0847002 , 0.1902938 ,-0.29582635;
		l0.Who << -0.6726321 ,-1.4382327 , 0.00272924, 1.5411487 ,-0.5106033 ,-0.98818266,  0.19582634, 0.72724   ,-2.2486358 ,-1.6963357 ,-1.4410273 , 0.13582234, -0.46870592,-0.37216958, 0.29494947, 0.6009064 ;

		l0.bii <<  0.4576415 , 0.5748084 ,-0.28063482,-0.3066906 ;
		l0.bif << -0.24698871, 0.2532206 , 0.5724018 ,-0.43173546;
		l0.big <<  0.05294889,-0.5537624 , 0.16013767, 0.34513864;
		l0.bio <<  1.0666384 , 0.1912728 , 1.3922554 ,-0.22757109;

		l0.bhi <<  1.0366042 ,-0.07975546,-0.16708578,-0.38108283;
		l0.bhf << -0.09017879, 0.13860753, 0.2626877 ,-0.43228355;
		l0.bhg << -0.30899653, 0.05103224,-0.34322152, 0.4682022 ;
		l0.bho << 1.1738678 ,0.2915683 ,0.62957436,0.390069  ;

		l0.htn1 << 0.,0.,0.,0.;
		l0.ctn1 << 0.,0.,0.,0.;

		l1.Wii << -0.10087327, 0.25020573, 0.08817308,-0.7710249 , 0.23750465,-0.3582187 ,  0.17340833, 0.00779419,-0.44913408, 0.02714528, 0.6659872 ,-0.16295414, -0.4923884 ,-0.36336285, 0.26706606, 0.49406403;
		l1.Wif << -0.17917307,-0.6969838 ,-0.10870749, 0.07496659,-0.5347314 ,-0.38451958, -0.127195  ,-0.3012019 ,-0.3345358 , 0.16904274,-0.6363028 , 0.26223475, -0.02784953,-0.40592027,-0.07923207, 0.40534183;
		l1.Wig <<  0.18330526, 0.40768817,-0.00237107, 0.02344959,-0.84929866, 0.4454104 ,  0.34133738, 0.2527639 ,-0.8430556 ,-0.11801845, 0.8601439 , 0.1738392 ,  0.30034563,-0.33608934, 0.16385093, 0.06155634;
		l1.Wio << -1.41005361e+00, 4.20758456e-01, 2.77578592e+00, 4.67867672e-01,  5.01451671e-01,-4.06737506e-01,-8.66285086e-01, 4.97868001e-01,  1.44580612e-03,-8.90046835e-01, 2.49638185e-01, 9.25809085e-01,  6.19104981e-01, 1.21164165e-01,-5.48744440e-01, 5.01619160e-01;

		l1.Whi << -0.58069444,-0.04971685,-0.79853505,-0.22302511, 0.33180186, 0.5112031 ,  0.22726426, 0.50602674, 1.4829501 , 1.0540342 ,-2.092173  , 0.51724106,  0.03473017, 0.53231597, 0.3397982 , 0.10582249;
		l1.Whf << -0.06273496, 0.4467321 , 0.0706958 , 0.20677052, 0.70179355, 0.75233895, -0.5768814 , 0.55693907, 0.13266699, 0.34717888, 0.64909375,-0.07206517,  0.5463873 , 0.03218305,-0.29426673, 0.03342962;
		l1.Whg <<  0.10077283, 0.5651591 ,-0.36003345,-0.31847006, 0.30975956,-0.08082471,  0.22735442, 0.20574364,-0.5402093 ,-0.43000042,-0.25758237, 0.02921141,  0.5862844 , 0.32428852,-0.6207132 , 0.08201403;
		l1.Who <<  0.483408  , 0.3122427 ,-0.04633158,-0.6286065 , 0.6868322 , 0.1199961 ,  0.24064156,-0.22302829, 1.0484356 , 0.74981976,-1.0502288 , 0.4918682 , -0.11338767, 0.3204495 , 0.26566434, 0.20024322;

		l1.bii << -0.08414654,-0.3174714 ,-0.02734437, 0.5466853 ;
		l1.bif << 0.61237806,0.1630775 ,0.32659823,0.23493709;
		l1.big <<  0.34789842,-0.13303569,-0.01045153, 0.14472076;
		l1.bio <<  0.06923737, 0.25039107, 0.33490035,-0.25437358;

		l1.bhi <<  0.14774653, 0.21367024,-0.5468757 , 0.60206413;
		l1.bhf <<  0.6834819 ,-0.01646572,-0.3667294 , 0.42126688;
		l1.bhg << 0.00612151,0.40690532,0.31589293,0.01645036;
		l1.bho << -0.02216779, 0.61193764, 0.26258084, 0.16678509;

		l1.htn1 << 0.,0.,0.,0.;
		l1.ctn1 << 0.,0.,0.,0.;

		f.A <<  0.48029938,-0.17035362, 0.7097976 ,-0.5044065 ;
		f.b << 0.08724364;
	}

	void apply_model(T* x, T* y) {
		l0.apply_layer(*x);
		l1.apply_layer(l0.ht);
		*y=f.apply_layer(l1.ht);
	}
};