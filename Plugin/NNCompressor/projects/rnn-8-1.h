/**
 * Autogenerated header file for rnn-8-1
 * neural network model parameters.
 * 
 * Created on: 03/10/2022 at: 10:19
 * By Michael Holmes
*/

#pragma once
#include "layers.h"

template<typename T>
class Rnn_8_1
{
public:
	const static int h = 8;
	const static int d = 1;
	const static int layers = 1;

	FccLayer<T, h, d> f;
	RnnLayer<T, h, d> l0;

	Rnn_8_1() {
		l0.Wih << -1.0104719 ,-1.2445518 ,-0.14760897,-1.7846098 ,-1.1380048 , 1.726847  ,  0.17627457, 0.04696293;

		l0.Whh <<  0.35848308,-0.06729728,-0.32881945, 0.04960677,-0.20325142,-0.0417577 ,  0.4774429 ,-0.28927884, 0.36997646,-0.09991776, 0.6495694 , 0.00634439, -0.09730758, 0.0700631 ,-0.31398088, 0.57314783, 0.04449876, 0.2211951 ,  0.8885421 ,-0.10325389,-0.02835545, 0.1369639 ,-0.19644623, 0.11457521,  0.3352639 ,-0.41323847,-0.04167278,-0.0539661 , 0.16595034,-0.23440833, -0.11069407, 0.141781  , 0.25822464,-0.39805785,-0.14323637,-0.08167489,  0.22301011,-0.22381276, 0.09438097,-0.5147528 , 0.08744797,-0.2772196 , -0.24120697, 0.3164663 ,-0.08886573, 0.06086904, 0.25300816,-0.25632155, -0.18665552,-0.10936162,-0.20404786, 0.14685282, 0.0706276 , 0.17052639,  0.12713106,-0.13517004, 0.10319311, 0.47038656, 0.20518449,-0.32775074, -0.21297574, 0.0463723 ,-0.4020116 ,-0.00284344;

		l0.bih << -0.21002235,-0.06572902, 0.19230777,-0.04835439, 0.059521  ,-0.27936655, -0.30450985,-0.13640101;

		l0.bhh << -0.08784267,-0.36084813, 0.10081744,-0.2005233 , 0.2746383 ,-0.09998523,  0.21096951, 0.19763641;

		l0.htn1 << 0.,0.,0.,0.,0.,0.,0.,0.;

		f.A << -0.25176963, 0.33883563,-0.20167461,-0.47240692, 0.4982961 , 0.3684467 , -0.3129835 , 0.1150392 ;
		f.b << -0.05823666;
	}

	void apply_model(T* x, T* y) {
		l0.apply_layer(*x);
		*y=f.apply_layer(l0.ht);
	}
};