/**
 * Autogenerated header file for rnn-4-4
 * neural network model parameters.
 * 
 * Created on: 03/10/2022 at: 10:19
 * By Michael Holmes
*/

#pragma once
#include "layers.h"

template<typename T>
class Rnn_4_4
{
public:
	const static int h = 4;
	const static int d = 1;
	const static int layers = 4;

	FccLayer<T, h, d> f;
	RnnLayer<T, h, d> l0;
	RnnLayer<T, h, h> l1;
	RnnLayer<T, h, h> l2;
	RnnLayer<T, h, h> l3;

	Rnn_4_4() {
		l0.Wih <<  0.9315215 ,-1.6558564 ,-0.10325249, 2.1970193 ;

		l0.Whh <<  0.40967533,-0.08108214, 0.43656713,-0.8437126 , 0.05684733, 0.08927614, -0.35692787, 0.4219292 , 1.1438857 ,-0.24164957, 0.6760968 ,-0.02619013, -0.45267648, 0.72611123, 0.01351567,-0.13732894;

		l0.bih <<  0.23939747,-0.3152251 ,-0.55183357, 0.3463919 ;

		l0.bhh <<  0.23091818,-0.34642354,-0.6155484 ,-0.02685513;

		l0.htn1 << 0.,0.,0.,0.;

		l1.Wih << -1.5025789 , 0.7474239 ,-0.13501884,-2.3247974 , 0.1468175 , 0.04559393,  1.0627385 ,-1.3766254 , 0.537908  , 0.01588612, 0.0863247 , 1.0272297 , -0.21042347,-0.08692385,-0.48056236, 0.9376688 ;

		l1.Whh << -0.00302888,-0.32519868,-0.26956478, 0.21639448,-0.01423775, 0.28962362, -0.11506301, 0.04610545, 0.44346094, 0.38637948,-0.41679865,-0.12546231,  0.19608895,-0.431093  , 0.0521007 , 0.00682012;

		l1.bih <<  0.35246614,-0.01507667,-0.1493856 ,-0.2463627 ;

		l1.bhh <<  0.56012136,-0.5369595 , 0.2548565 ,-0.0157051 ;

		l1.htn1 << 0.,0.,0.,0.;

		l2.Wih << -0.39902014,-0.13581562, 0.18687965,-0.52348524, 0.39958546,-0.23347002, -0.29812694, 0.09433543, 0.67541444, 0.2828418 ,-0.8808627 ,-0.3135039 , -0.25789294,-0.51251286, 0.09062625,-0.17301221;

		l2.Whh <<  3.6014390e-01, 3.1910786e-01,-2.0375332e-01, 2.1387710e-01,  3.3159617e-02,-3.0632126e-01, 3.1296693e-02,-3.7170917e-01,  1.7173584e-01, 3.4536690e-01, 3.6071262e-01,-1.4600658e-01,  2.3854713e-01, 4.5966521e-01, 4.3358738e-04, 1.3851538e-01;

		l2.bih << -0.08421056,-0.2790538 , 0.22017753, 0.31851572;

		l2.bhh << -0.3194949 ,-0.2563916 ,-0.22271849, 0.34143054;

		l2.htn1 << 0.,0.,0.,0.;

		l3.Wih << -0.26563346,-0.2830662 , 0.2488352 , 0.07055547, 0.4217168 , 0.257569  , -0.2102743 , 0.03718962, 0.09970601,-0.14482608,-0.04297564, 0.00321576,  0.21109217, 0.37506768, 0.02770434, 0.50471026;

		l3.Whh << -0.01496095, 0.27587798, 0.45723405,-0.3457543 ,-0.4205788 ,-0.28446257, -0.05706016, 0.36168197, 0.3057461 , 0.47623238, 0.10174152,-0.16392283, -0.30442083, 0.28893924,-0.1560029 ,-0.21844189;

		l3.bih << -0.52465886, 0.09827567,-0.11267006, 0.40877873;

		l3.bhh <<  0.1551421 , 0.10238243,-0.19903839,-0.3894912 ;

		l3.htn1 << 0.,0.,0.,0.;

		f.A <<  0.14003934,-0.4091425 ,-0.07050643,-0.4202682 ;
		f.b << 0.18697527;
	}

	void apply_model(T* x, T* y) {
		l0.apply_layer(*x);
		l1.apply_layer(l0.ht);
		l2.apply_layer(l1.ht);
		l3.apply_layer(l2.ht);
		*y=f.apply_layer(l3.ht);
	}
};