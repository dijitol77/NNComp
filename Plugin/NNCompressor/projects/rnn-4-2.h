/**
 * Autogenerated header file for rnn-4-2
 * neural network model parameters.
 * 
 * Created on: 03/10/2022 at: 10:19
 * By Michael Holmes
*/

#pragma once
#include "layers.h"

template<typename T>
class Rnn_4_2
{
public:
	const static int h = 4;
	const static int d = 1;
	const static int layers = 2;

	FccLayer<T, h, d> f;
	RnnLayer<T, h, d> l0;
	RnnLayer<T, h, h> l1;

	Rnn_4_2() {
		l0.Wih << -0.7641525,-2.170938 ,-3.3177743, 1.6444587;

		l0.Whh <<  0.15292361,-0.42343518, 0.42897373,-0.04844489, 0.3896424 , 0.43099037,  0.8278761 ,-0.02794668,-0.74310386, 0.5688661 ,-0.7089677 ,-0.07437804,  1.2105962 , 0.6156074 , 1.2762611 ,-0.14833477;

		l0.bih << -0.06375539,-0.09946165, 0.00039329, 0.15916412;

		l0.bhh <<  0.07518297, 0.14388879,-0.07234067,-0.06315058;

		l0.htn1 << 0.,0.,0.,0.;

		l1.Wih <<  0.20215914,-0.13239339,-1.0504835 , 0.58724517,-0.08805969,-0.41035822,  0.26139578, 0.09402591,-0.45126632, 0.23512302,-0.10377465, 0.0272059 ,  0.49106863, 0.5424334 , 0.37444782, 0.47922778;

		l1.Whh <<  0.81809086, 0.17532243,-0.27424708, 0.51467806, 0.07009848, 0.44989705,  0.05719742,-0.16287218,-0.15242687,-0.01511888, 0.15565023,-0.1492239 , -0.4972751 ,-0.34240258,-0.01299326,-0.02044555;

		l1.bih <<  0.22883806, 0.68488115,-0.11670925,-0.04507213;

		l1.bhh << -0.3452019 , 0.51348436, 0.3855292 , 0.33463517;

		l1.htn1 << 0.,0.,0.,0.;

		f.A <<  0.16077106, 0.21200751,-0.34766006, 0.05411138;
		f.b << -0.08815242;
	}

	void apply_model(T* x, T* y) {
		l0.apply_layer(*x);
		l1.apply_layer(l0.ht);
		*y=f.apply_layer(l1.ht);
	}
};