/**
 * Autogenerated header file for lstm-8-1
 * neural network model parameters.
 * 
 * Created on: 03/10/2022 at: 10:19
 * By Michael Holmes
*/

#pragma once
#include "layers.h"

template<typename T>
class Lstm_8_1
{
public:
	const static int h = 8;
	const static int d = 1;
	const static int layers = 1;

	FccLayer<T, h, d> f;
	LstmLayer<T, h, d> l0;

	Lstm_8_1() {
		l0.Wii << -1.5364909 , 0.30686668, 0.22601756, 0.28260782, 0.04452053, 0.35582164, -0.28118595,-0.36517638;
		l0.Wif <<  0.8015449 ,-0.71728754, 0.29311794, 0.32368788,-0.5399201 ,-1.2816257 ,  0.1512787 ,-1.932779  ;
		l0.Wig <<  0.41912642,-0.43669745, 0.02806793, 0.28199625,-0.23929136, 0.7369762 , -0.22313769, 1.6026275 ;
		l0.Wio << -0.21427204, 1.3229934 , 1.7367517 , 0.9557925 , 0.08753759, 0.09863457, -0.3961901 ,-0.45353648;

		l0.Whi <<  0.3614109 , 0.18781868, 0.13090882,-0.00536288,-0.09797997,-0.0994938 ,  0.84550303,-1.1204302 , 0.3113338 ,-0.15694895, 0.22057249,-0.31065556, -0.01064559, 0.00500153,-0.24880241,-0.44424105, 0.53417426, 0.31615692, -0.32579482,-0.02762988, 0.14079438, 0.01114815,-0.06261633,-0.53612864,  0.13092738,-0.17591417,-0.35267898,-0.06837989,-0.36640367,-0.48577482,  0.29879478, 0.00934707, 0.22111987, 0.10938625, 0.15502192, 0.25287324, -0.34152177,-0.1997937 , 0.05634498, 0.05283938, 0.7164157 , 0.5121351 , -0.41451186, 0.22230914, 0.29074106, 0.12282859,-0.15066615,-0.50429887,  0.22761577, 0.26095974,-0.22994114, 0.29564917, 0.03709609,-0.28021902,  0.5820711 ,-0.87914485, 1.6901277 , 1.562248  ,-0.88829935,-0.12049369,  0.552653  ,-0.9375454 ,-1.9579123 , 0.12658511;
		l0.Whf <<  3.5452551e-01, 2.6746988e-01,-4.8754859e-01, 4.0720150e-01, -1.3068323e-01,-3.9818642e-01, 4.2752439e-01,-5.4514909e-01,  5.2903032e-01, 1.1792477e-01,-3.3041942e-01,-5.0331773e-03,  2.1858838e-01,-4.7220361e-01, 1.5574214e-01,-9.2788583e-01,  2.2834577e-01, 7.8236289e-02, 5.7021126e-02, 3.1162059e-01,  3.2282233e-01,-4.5383027e-01, 2.6718158e-01,-9.7623706e-02,  1.1932306e-01, 5.1003646e-02,-2.4672762e-01,-6.9558635e-02, -3.6916512e-01,-4.9662936e-01, 3.6769465e-01, 2.0618263e-01, -4.2430896e-01,-2.2532327e-01,-2.9133773e-01, 1.7865542e-01, -1.8913351e-01, 9.6492589e-02, 5.2558917e-01, 3.6378211e-01,  4.0628448e-01,-1.6826384e-01, 4.7587800e-01,-5.2529097e-01,  5.7747489e-01, 2.2137851e-02,-4.0753603e-01,-1.4362215e-01, -3.9800012e-01,-3.3358872e-01, 7.4053742e-02,-2.3289326e-01, -1.5526409e-01,-2.2520618e-01, 7.4412119e-01,-5.8437747e-01,  3.3181545e-01, 5.6016147e-01,-1.2802528e-03,-3.2630286e-01,  1.0488034e+00, 2.5725091e-01,-9.9929649e-01, 1.6555647e+00;
		l0.Whg <<  2.91795164e-01, 2.31237382e-01,-6.65685534e-02,-3.52460682e-01,  2.12891102e-01, 2.82057494e-01,-5.53701460e-01, 2.70791680e-01,  5.07053018e-01, 2.21989274e-01, 1.41030878e-01, 1.36611536e-02, -2.53255397e-01,-4.62327778e-01,-2.64744252e-01,-6.74283743e-01, -5.30453511e-02,-3.50882143e-01, 3.22319388e-01,-8.01150650e-02, -1.55721545e-01, 1.00044765e-01, 2.77000159e-01, 3.00021350e-01, -2.23857492e-01, 1.54758826e-01, 9.57578777e-06, 1.67238295e-01, -3.79920870e-01,-7.45029822e-02, 2.92159468e-01, 9.50497761e-02,  4.20059413e-01,-2.50105858e-01,-5.40363453e-02,-3.05818319e-01,  2.03563571e-01, 1.93563700e-01,-3.50976139e-01, 2.90858168e-02,  1.42143160e-01,-1.53320596e-01, 1.85957596e-01,-2.30338752e-01,  7.73143619e-02, 1.04481675e-01, 1.07511207e-01, 9.14806649e-02,  1.17866948e-01,-4.61762905e-01, 3.47907722e-01, 2.24822804e-01, -2.59674609e-01, 2.53325045e-01, 2.07153693e-01,-1.18085973e-01,  1.92545727e-01,-2.45429110e-02, 9.23380628e-02, 1.19571649e-01, -3.39931071e-01,-2.04455301e-01, 3.92169766e-02,-3.26198459e-01;
		l0.Who <<  0.5811478 , 0.08466137,-0.5636892 , 0.6274626 ,-0.27017054,-0.60631424, -0.01661632,-0.7731078 , 0.04548478, 0.41928875,-0.17294729, 0.24530733,  0.03948498,-0.31801128, 0.42942107,-0.31496808, 0.47393715, 0.05449375,  0.21942435, 0.2583464 ,-0.20828117,-0.42039204, 0.17954251,-0.6163387 , -0.32937685,-0.0982516 , 0.14252284, 0.0545548 , 0.09173834,-0.34814405,  0.5115237 , 0.28006896, 0.24232326, 0.22577186,-0.24394068,-0.13179572,  0.07247336,-0.43229252, 0.67413193,-0.4344754 , 1.1205926 ,-0.02792664, -0.4934889 , 0.06288507, 0.26346222,-0.03923456,-0.63874465,-0.35369757,  0.10141031,-0.1862179 , 0.12208106, 0.5048779 ,-0.63616014, 0.20655142,  0.5616769 ,-0.6272655 , 1.6527097 , 1.2875395 ,-0.93331975,-0.03405052,  0.28439173,-0.87796974,-1.7965674 , 0.6698642 ;

		l0.bii << -0.23082052, 0.40740913,-0.12345802,-0.2636967 , 0.31098574,-0.06594045,  0.01152216,-0.14593007;
		l0.bif <<  0.16247638,-0.0919233 , 0.42323127,-0.09620769, 0.04581475,-0.01932082,  0.2117552 ,-0.75131094;
		l0.big <<  0.17431343, 0.17684346,-0.10538725, 0.21518569,-0.09763961,-0.24515197,  0.04139756, 0.09878925;
		l0.bio <<  0.2503849 , 0.46244064,-0.05903602,-0.15735462,-0.21401632, 0.20302   , -0.0123167 ,-0.04475649;

		l0.bhi <<  0.07341991, 0.17464064, 0.06218174,-0.21015963,-0.01936158, 0.56829906,  0.15309165,-0.36268368;
		l0.bhf <<  0.49248493, 0.34401518, 0.2543289 , 0.14519668, 0.194051  ,-0.04133545,  0.17246518,-0.37635607;
		l0.bhg << -0.17118193, 0.0084568 ,-0.20794103, 0.1931436 ,-0.01221483, 0.18431646,  0.09241755,-0.2535322 ;
		l0.bho <<  0.24979177, 0.1719858 ,-0.23561515,-0.16866899, 0.27393815, 0.15654726,  0.2855998 , 0.03712488;

		l0.htn1 << 0.,0.,0.,0.,0.,0.,0.,0.;
		l0.ctn1 << 0.,0.,0.,0.,0.,0.,0.,0.;

		f.A << -0.035661  , 0.1292121 ,-0.5131816 , 0.15557818,-0.20312908, 0.5554498 , -0.01062484, 0.73435044;
		f.b << -0.16015466;
	}

	void apply_model(T* x, T* y) {
		l0.apply_layer(*x);
		*y=f.apply_layer(l0.ht);
	}
};