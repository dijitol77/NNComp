/**
 * Autogenerated header file for gru-8-2
 * neural network model parameters.
 * 
 * Created on: 03/10/2022 at: 10:19
 * By Michael Holmes
*/

#pragma once
#include "layers.h"

template<typename T>
class Gru_8_2
{
public:
	const static int h = 8;
	const static int d = 1;
	const static int layers = 2;

	FccLayer<T, h, d> f;
	GruLayer<T, h, d> l0;
	GruLayer<T, h, h> l1;

	Gru_8_2() {
		l0.Wir <<  0.45656258, 0.44866747, 0.46986613, 0.17708106, 2.4579532 ,-0.0569401 , -1.2990896 , 3.8109558 ;
		l0.Wiz <<  2.4748726,-3.2389612,-1.2617847, 0.5872553, 1.3211089, 1.3740914, -2.9897563, 1.1088424;
		l0.Win << -0.55284226, 0.26850736,-1.2868751 ,-0.7271688 ,-0.7030903 , 0.936395  ,  0.4784288 , 1.4717445 ;

		l0.Whr <<  0.16640879,-0.36588764, 0.51506555, 0.05717129,-0.34886542, 0.24880457,  0.0143964 , 0.15409805,-0.30573374,-0.18430306,-0.6943119 ,-0.47180477, -0.12804267,-0.44479164,-0.14398953, 0.22080277,-0.38108948, 1.1014203 , -1.636234  , 0.41191414,-0.00535361, 0.22971304,-0.49742997, 1.5286891 , -0.95471066, 0.91903484,-0.09715643,-0.2881138 , 0.0400953 , 0.68068343,  0.31854907, 0.15060428,-0.11986198,-0.17911015,-0.3896147 ,-0.0790007 , -0.02665835, 0.6552728 , 1.3418496 , 1.6939358 , 0.04937571, 0.37783265, -0.20127024,-0.15867727, 0.55959904,-0.31755036,-0.33185887,-0.40187478, -0.19819896, 0.12203402, 0.5035167 , 0.33922666, 0.15468726, 0.45330587,  0.0031341 ,-0.06664231,-0.23743974, 0.12316334,-0.42334124,-0.27331114,  0.42422307, 0.13298029, 0.38000533, 0.6742895 ;
		l0.Whz <<  0.2904404 ,-2.1620595 , 1.740393  ,-0.59566724,-1.384388  , 1.0948918 , -0.91078615,-1.0944049 ,-0.8992085 ,-0.3333442 , 2.8294582 , 1.2140541 , -0.5670815 ,-0.53809184,-4.105751  ,-2.192137  ,-1.2590688 , 1.3252976 , -1.5394677 ,-1.4773371 , 1.2913004 ,-0.4572496 , 0.12558608,-0.86206794, -0.572873  , 0.6107151 , 3.0140114 , 0.6625726 ,-0.95516545, 1.4081886 ,  3.5286393 , 1.2699347 ,-0.27868435, 0.7317276 ,-1.9454938 ,-0.7193127 ,  0.6192415 ,-0.13978533, 2.7824779 ,-1.2177718 , 1.2162052 ,-1.6308839 , -0.6695531 ,-0.37183288,-0.35188204, 1.0784893 , 0.6937952 ,-1.1372739 , -4.381432  , 0.7315799 , 3.7948484 ,-0.25401622,-2.0022707 , 5.2380805 ,  5.831481  , 4.3077903 , 0.5311347 ,-0.23764014, 1.0226026 ,-0.6878745 , -0.0453743 ,-0.61370003, 2.6466284 , 0.4163118 ;
		l0.Whn << -0.07624738, 0.10606439,-0.0994112 ,-0.00859537, 0.13711432,-0.33089188,  0.08224984,-0.21297057, 0.04441574, 0.06309429,-0.07133133,-0.27649137, -0.13010478, 0.37537304,-0.13092095, 0.5126838 , 0.41669187, 0.02010812,  0.46119747, 0.09585705,-0.19641949,-0.12008464,-0.01531673,-0.90665185, -0.24235366, 0.12207795,-0.16633086, 0.14895673,-0.33776012, 0.34834936, -0.22976178, 0.23238127, 0.1707209 , 0.3280835 ,-0.4803014 ,-0.12748286,  0.23497069,-0.02704413, 0.56456065, 0.22102872,-0.13787854,-0.1633688 ,  0.0700344 ,-0.23128507,-0.34639946, 0.00754854, 0.26031694, 0.1041854 ,  0.82886165, 0.14107557,-0.2792888 ,-0.3581669 , 0.5765308 ,-0.39446944,  0.7942617 ,-0.6248056 , 0.06582772,-0.1666917 ,-0.05970737, 0.15232207, -0.3726565 ,-0.05703497,-0.6152316 , 0.5549066 ;

		l0.bir << -0.01499693,-0.19377677, 0.11840404,-0.1761857 , 0.43381685,-0.34073922,  0.50012743, 0.09567393;
		l0.biz << -0.3457871 ,-0.64012057, 0.7431099 ,-1.3155078 ,-2.3746731 , 0.54826665,  1.3044794 ,-0.5095477 ;
		l0.bin <<  0.12618144, 0.05664528, 0.31768385, 0.35068104, 0.19111718, 0.30539775,  0.2763051 ,-0.13670878;

		l0.bhr <<  0.04622311, 0.09362509,-0.29396847,-0.30697387, 0.43631122, 0.05663537,  0.14841413,-0.3806351 ;
		l0.bhz << -0.00640721,-1.0882583 , 1.0204453 ,-1.7581183 ,-2.0954068 , 0.55681777,  1.7216281 ,-0.17138937;
		l0.bhn << -0.4072977 , 0.13912505,-0.13268375, 0.00067488, 0.23883979,-0.2874453 , -0.25093687, 0.27903306;

		l0.htn1 << 0.,0.,0.,0.,0.,0.,0.,0.;

		l1.Wir <<  1.99070036e-01, 4.68672626e-02, 2.87753493e-01,-2.77417302e-01, -2.87265182e-01,-2.28230312e-01,-4.81575906e-01, 4.67017991e-03, -5.19939363e-01, 7.62935519e-01, 2.27625892e-01, 4.52583104e-01, -9.71578993e-03,-1.00449659e-01,-1.17820930e+00, 2.42909670e-01,  2.71904707e-01,-2.35295504e-01, 9.60382074e-02,-1.73313856e-01,  3.01448613e-01,-7.07785904e-01,-1.08184087e+00,-5.20827115e-01, -5.87915666e-02, 3.97346795e-01, 4.61778380e-02, 2.62100428e-01,  2.84880698e-01, 8.00125226e-02, 2.97874779e-01, 1.26173645e-01, -2.68346518e-01, 3.06465626e-01,-5.93693614e-01, 1.41184464e-01,  8.11482444e-02,-3.31503488e-02, 2.67096590e-02,-1.23027183e-01,  1.84933662e-01, 4.09828156e-01, 5.17580628e-01, 2.76944667e-01, -6.58264980e-02,-4.54789937e-01, 2.70045865e-02, 9.91042331e-02,  2.95879394e-01,-1.54621273e-01,-4.22888428e-01, 3.73730846e-02, -2.26915628e-01,-4.28758226e-02,-5.52279060e-04, 3.04588377e-01,  1.27327189e-01, 3.03575039e-01,-1.16033924e+00,-1.02977745e-01, -2.81198829e-01,-2.02410892e-02,-3.40658784e-01, 5.12779057e-01;
		l1.Wiz << -1.5905762 ,-0.7512498 , 1.5168705 , 0.5536709 ,-1.2099698 , 0.93778366, -2.1837893 ,-1.5039393 ,-1.034915  , 1.0377971 ,-1.3285438 ,-0.5753548 , -0.01493329, 1.834316  , 1.5073441 , 1.360427  ,-1.1002136 , 0.47530496, -1.8164487 ,-1.6511501 ,-0.01953006, 1.0050216 , 1.2155812 , 1.1168635 , -0.9056723 ,-1.4501188 ,-0.8860899 ,-0.74979985, 0.32672226,-0.1663079 , -0.4895971 ,-0.14649284,-0.56819224,-1.7477343 ,-0.8522444 ,-0.5918796 ,  0.5569079 , 1.6579291 , 1.0416492 ,-1.9511889 ,-1.0429102 , 0.3402184 ,  0.73558223, 0.99921453, 1.2309365 , 0.87094235,-0.6493124 ,-0.32285768, -0.39715627,-2.4041576 , 0.87890714,-0.7444446 , 0.20226972,-0.65116626,  2.031314  ,-1.5173429 ,-0.30774957, 0.22141065, 0.00533509,-0.33189368,  1.6272061 , 0.68494684, 1.3043183 ,-0.9980012 ;
		l1.Win << -0.29572022, 0.09000791,-0.24881572, 0.17415074,-0.03998614,-0.07794986, -0.23140597, 0.45185426, 0.1394122 , 0.05350109,-0.14213833,-0.08828479,  0.44008398, 0.11981521, 0.15143079,-0.15286058,-0.17343755, 0.07083523,  0.2698581 , 0.25437438, 0.26757   ,-0.29413614, 0.00377923,-0.54335356,  0.2628815 , 0.27081022,-0.02881009, 0.04963512, 0.20671771,-0.05469057,  0.2788475 ,-0.5698229 ,-0.1846628 ,-0.4650723 ,-0.07795374, 0.1684694 , -0.07230453,-0.34780958, 0.3415536 , 0.41543323,-0.27298665,-0.19448493, -0.18648009, 0.30864355,-0.15215328,-0.05979884, 0.16276486, 0.37000394,  0.2920866 , 0.08716591, 0.36784616,-0.3365071 ,-0.4135045 ,-0.23845953,  0.08323878, 0.32020792, 0.07809686,-0.2867419 ,-0.35145286,-0.18853064, -0.3348973 , 0.4503758 , 0.2902544 , 0.9890308 ;

		l1.Whr << -0.04046447,-0.76189363, 0.29138458,-0.12874015,-0.01655655,-0.28826496,  0.14443433, 0.21587533, 0.77616286, 0.20947385,-0.46357775,-0.526945  , -0.6762309 ,-1.9042032 ,-1.1556873 , 0.28948346, 0.36916548, 0.18762876,  0.27939096,-0.2681483 ,-0.6618802 , 2.0364928 ,-0.26519173,-0.07066824,  0.0495252 ,-0.10017602, 0.22384563,-0.06095585, 0.08308909,-0.66422933, -0.20227087, 0.3194647 ,-0.4277587 , 0.5479037 , 0.02756778,-0.32283488, -0.21521682, 0.6614918 , 0.13295183,-0.07985613, 0.4130129 , 0.08369579, -0.09609787,-0.19237503,-0.17143844,-0.870377  , 0.35723713,-0.44464248,  0.22467902, 0.199254  ,-0.05616431, 0.7726076 ,-0.03856107, 0.38854322, -0.53227764,-0.14657973, 0.3728738 ,-0.31626782, 0.08475524, 0.03326145, -0.89912724, 0.93679523,-0.71986234, 0.38876113;
		l1.Whz <<  1.2189250e+00, 2.8621378e+00, 3.4017128e-01,-5.8572543e-01, -1.2841960e+00, 5.4844201e-01,-1.0083878e+00, 9.1290390e-01,  7.5869888e-01, 7.2678280e-01, 8.2110238e-01, 4.7067621e-01,  2.2229195e+00,-3.0388710e+00,-2.1705857e-01, 4.1924661e-01,  2.1451816e-01, 1.8549569e-01,-3.9316446e-02,-4.5951733e-01,  2.0024388e+00,-2.0912561e+00,-6.9576162e-01, 7.7498978e-01,  1.9654704e+00, 1.3182910e-01,-6.9768298e-01,-7.5040245e-01, -1.9254754e+00,-1.5385873e+00,-2.6493969e+00,-2.0082472e-01,  8.6902016e-01,-3.6051983e-01,-8.8387442e-01,-9.0117198e-01,  1.7637964e+00, 6.6225868e-01,-1.2354133e-01, 3.0561969e-01,  1.3240422e+00, 7.1547353e-01, 1.1606984e+00, 9.9952114e-01, -2.9468980e-01,-4.6908784e-01, 1.4765804e-01, 4.4826114e-01,  1.5218996e+00, 1.1752761e-01,-7.1629983e-01,-9.8838902e-01,  1.4606549e+00, 1.0183673e+00,-1.2740389e+00,-3.0024059e-02, -4.1426018e-01,-2.4035101e-01,-1.4961597e+00, 2.8922427e-01,  1.2056246e+00, 4.2914647e-01,-1.1566438e-01, 2.5716482e-03;
		l1.Whn << -0.14454009,-0.13898383, 0.26123115, 0.15862656,-0.30128378, 0.10610436,  0.39499798, 0.11638816, 0.32283562,-0.34382743,-0.97711134, 0.42173108, -0.04336803,-0.0949777 , 0.147784  , 0.780253  ,-0.06379655,-0.07030497,  0.1775377 ,-0.18561766,-0.17379326, 0.48712784, 0.29789317,-0.45307466,  0.34721747,-0.16834803, 0.08850364,-0.18475607,-0.13266201, 0.2119455 , -0.06134365, 0.3716883 ,-0.33386183, 0.15922588,-0.09631784, 0.69016796, -0.32992944,-0.40040317, 0.00627116,-0.56705946, 0.02332989, 0.741713  , -0.28406528, 0.07125136, 0.12140445, 0.5690414 , 0.21796663, 0.25120685, -0.18238303, 0.17985441, 0.43986827, 0.41586566, 0.18656889, 0.28643578, -0.48624742,-0.05961721,-0.10879788,-0.09547399,-0.3642375 , 0.35959008,  0.07268602,-0.12173905, 0.2962669 , 0.4494591 ;

		l1.bir <<  0.06980753, 0.23163953,-0.16502103,-0.0852915 ,-0.24701934,-0.15485238,  0.11800291, 0.03188771;
		l1.biz <<  0.03219535, 0.3159495 ,-0.35503086,-1.3260628 ,-0.52089703, 1.9918661 , -1.4812835 ,-0.15992898;
		l1.bin <<  0.29647493, 0.3248006 ,-0.05540978, 0.00906564, 0.0035224 , 0.04089879, -0.02458126, 0.26127216;

		l1.bhr << -0.32934105, 0.42844358, 0.3417254 , 0.00919002, 0.26204947,-0.05145871, -0.36827734, 0.01250089;
		l1.bhz << -0.36191547, 0.43882447,-0.44775724,-1.3722099 ,-0.34911677, 1.6799475 , -1.4483681 ,-0.5464187 ;
		l1.bhn <<  0.09132868,-0.3616623 , 0.09670886, 0.20240255,-0.07153431,-0.03304608,  0.22428282, 0.11864106;

		l1.htn1 << 0.,0.,0.,0.,0.,0.,0.,0.;

		f.A <<  0.12179868, 0.04144806, 0.23233043, 0.39631617,-0.44079885, 0.21931869, -0.47560063,-0.31639093;
		f.b << -0.23360391;
	}

	void apply_model(T* x, T* y) {
		l0.apply_layer(*x);
		l1.apply_layer(l0.ht);
		*y=f.apply_layer(l1.ht);
	}
};