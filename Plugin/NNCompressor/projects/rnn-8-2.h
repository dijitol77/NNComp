/**
 * Autogenerated header file for rnn-8-2
 * neural network model parameters.
 * 
 * Created on: 03/10/2022 at: 10:19
 * By Michael Holmes
*/

#pragma once
#include "layers.h"

template<typename T>
class Rnn_8_2
{
public:
	const static int h = 8;
	const static int d = 1;
	const static int layers = 2;

	FccLayer<T, h, d> f;
	RnnLayer<T, h, d> l0;
	RnnLayer<T, h, h> l1;

	Rnn_8_2() {
		l0.Wih <<  0.53972965,-0.9836636 , 0.45802483,-0.00283309,-1.2838473 , 1.0953641 , -0.5572767 ,-0.5396985 ;

		l0.Whh <<  0.05831897, 1.1928703 ,-0.18933049,-0.4497246 , 0.23313381,-0.24404281,  0.25890356, 0.6462065 , 0.5100495 , 0.07263032,-0.27079377, 0.09564871, -0.19445081, 0.24222091, 0.08400942,-0.08922133, 0.6889065 ,-0.39138153, -0.01044783,-0.04128681,-0.40675846, 0.22533627,-0.13587976,-0.01266574,  0.08271636,-0.07994746,-0.2887781 , 0.09990571, 0.10409123, 0.09646836,  0.20192927, 0.25886375,-0.25459087, 0.03804073,-0.4029113 , 0.1489885 , -0.09438401,-0.2848729 ,-0.5654613 , 0.22451381, 0.5698701 , 0.32193008, -0.35948172, 0.59903437, 0.47013247, 0.26670825, 0.35738352,-0.39719668, -0.15307182, 0.20310791, 0.19229592, 0.14580454,-0.08462425, 0.0574909 ,  0.22903576,-0.18996026, 0.12080079,-0.42394534, 0.26350635, 0.00907647, -0.37040678, 0.03050659,-0.2569755 ,-0.17957044;

		l0.bih << -0.2485138 , 0.09769586,-0.3486937 , 0.32695922,-0.03148286, 0.02866041,  0.03015785, 0.10487155;

		l0.bhh <<  0.16504171,-0.18373056, 0.05425319,-0.28342143,-0.1997447 , 0.0223763 , -0.04099837, 0.1637641 ;

		l0.htn1 << 0.,0.,0.,0.,0.,0.,0.,0.;

		l1.Wih <<  0.05249105,-0.13322528, 0.0678345 ,-0.15774417, 0.04675737, 0.23712988,  0.11872865, 0.11694715,-0.11155651,-0.00540163,-0.26107576,-0.03783966, -0.37655777, 0.23859395,-0.10129175, 0.05104408, 0.22384816,-0.19564284,  0.27306208,-0.03695939, 0.12229097,-0.11795866, 0.22028536,-0.39832002, -0.3104709 , 0.13970107,-0.0150427 , 0.11749585,-0.2520953 , 0.07024474,  0.05506477,-0.26177058, 0.06943792,-0.5966356 ,-0.11062347, 0.3994787 , -0.0933617 , 0.00878303, 0.11493146, 0.22350492, 0.04922855,-0.47058266, -0.16083772,-0.28519303, 0.3001843 ,-0.01831702, 0.01048868,-0.24246565, -0.01681432,-0.35232404,-0.17492618,-0.42320326, 0.45856383,-0.58442235, -0.0522879 , 0.3230044 , 0.41071188, 0.28745365, 0.3648594 , 0.0573773 , -0.08140284,-0.05106562,-0.35632402,-0.07699412;

		l1.Whh <<  0.7467067 , 0.09536905,-0.3055237 , 0.09284824,-0.07725948, 0.1087347 ,  0.13354903,-0.28830054, 0.4887895 , 0.4449866 ,-0.28992197,-0.21182846, -0.5643369 ,-0.16600542, 0.34041408, 0.13586313, 0.0276475 ,-0.25982258, -0.10539874, 0.21527429, 0.10213868,-0.01341822, 0.11053339,-0.3110987 ,  0.08541612,-0.05467131, 0.39731583,-0.2931769 , 0.14388414, 0.23918174, -0.11418138, 0.10917863,-0.58106035,-0.36788747,-0.3146993 ,-0.29984578,  0.43519488,-0.20144318, 0.13120611,-0.13132916, 0.6852768 , 0.22088367,  0.2685293 , 0.29123098,-0.8005839 , 0.53251714, 0.53932667,-0.20289208,  0.08547141,-0.09999112,-0.11396462,-0.18099362, 0.02039569,-0.76337034,  0.4547075 , 0.22044703, 0.0398822 ,-0.04790007,-0.33332127,-0.00896843,  0.03359932, 0.12255696, 0.05573456, 0.04030858;

		l1.bih << -0.23605391,-0.16744642,-0.38306335,-0.10244554,-0.16809388, 0.15653357, -0.05715143, 0.24541232;

		l1.bhh <<  0.10863952, 0.05134977,-0.04726969,-0.31081346,-0.03833888, 0.03059589, -0.10730618,-0.13753347;

		l1.htn1 << 0.,0.,0.,0.,0.,0.,0.,0.;

		f.A << -0.23536669, 0.04463284,-0.22240706,-0.04023401, 0.23289102, 0.35081643,  0.05571971, 0.14257185;
		f.b << -0.18574655;
	}

	void apply_model(T* x, T* y) {
		l0.apply_layer(*x);
		l1.apply_layer(l0.ht);
		*y=f.apply_layer(l1.ht);
	}
};