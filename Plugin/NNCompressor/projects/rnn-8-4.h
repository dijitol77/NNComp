/**
 * Autogenerated header file for rnn-8-4
 * neural network model parameters.
 * 
 * Created on: 03/10/2022 at: 10:19
 * By Michael Holmes
*/

#pragma once
#include "layers.h"

template<typename T>
class Rnn_8_4
{
public:
	const static int h = 8;
	const static int d = 1;
	const static int layers = 4;

	FccLayer<T, h, d> f;
	RnnLayer<T, h, d> l0;
	RnnLayer<T, h, h> l1;
	RnnLayer<T, h, h> l2;
	RnnLayer<T, h, h> l3;

	Rnn_8_4() {
		l0.Wih <<  1.2227257 , 0.75010705,-0.32444337,-0.59909606,-0.5507833 , 0.10047196,  0.80711883, 0.27951935;

		l0.Whh <<  0.25627562,-0.05223717, 0.30484933,-0.04604909, 0.17817846, 0.1631568 ,  0.09482902, 0.2975577 , 0.00327862, 0.11045806, 0.31755897, 0.0877485 , -0.22798452,-0.07553932,-0.17578737, 0.17809436,-0.29522532, 0.4427245 ,  0.2564853 , 0.40038303,-0.32207444,-0.03414947, 0.022354  , 0.16052163,  0.10603083, 0.29461044, 0.19856378,-0.1436887 ,-0.12871712,-0.3652077 ,  0.20504178,-0.15401879, 0.32693774,-0.01434369,-0.41155714,-0.2594807 ,  0.39466363, 0.08961801, 0.1583566 ,-0.10588669,-0.06885663,-0.3622778 , -0.16140871, 0.24067834, 0.3783215 ,-0.16185972, 0.13308415, 0.04621101, -0.05427891, 0.2184576 ,-0.375763  ,-0.11485989,-0.20661053, 0.07440753, -0.1572138 ,-0.46313035, 0.2607449 , 0.29156926,-0.65185636,-0.6596875 , -0.6235743 , 0.5580956 , 0.13618588,-0.87732065;

		l0.bih << -0.14140107,-0.04201645,-0.21467459, 0.1565719 , 0.00839141,-0.05991765, -0.12253162, 0.29080677;

		l0.bhh << -0.30281729, 0.04575079,-0.2225387 ,-0.3000744 ,-0.09530942,-0.24746895,  0.18522473,-0.2188275 ;

		l0.htn1 << 0.,0.,0.,0.,0.,0.,0.,0.;

		l1.Wih <<  0.14915214, 0.35585365, 0.32276574, 0.5205088 ,-0.23138341, 0.18907197,  0.21146692,-0.01173377, 0.32809585, 0.47373527,-0.33545884,-0.2637227 , -0.15276529,-0.19781749, 0.44399196, 0.71348643, 0.14310203,-0.11642591,  0.55354697, 0.52694976, 0.27478665,-0.2188641 ,-0.49726215,-0.5596688 , -0.05055894, 0.09560638,-0.02565871, 0.23796329, 0.09347442,-0.04890957,  0.35535645, 0.91722274, 0.18492721,-0.36725444, 0.9371492 , 0.87725925, -0.13207155,-0.12895004,-0.28932267,-1.5890833 , 0.2722178 , 0.8117737 ,  0.4039667 , 0.22612825,-0.61504567,-0.00391605, 0.3556033 , 0.07797629, -0.04183041,-0.42329955,-1.0426042 ,-0.60690707, 0.14847158, 0.6389959 , -0.5193161 ,-0.67616576, 0.03078966, 0.30839074,-0.47035703, 0.00900872,  0.47412163,-0.02105991,-0.06213966, 0.29594535;

		l1.Whh <<  0.3093522 ,-0.09805387, 0.14187568, 0.11492069, 0.40454113, 0.09891739, -0.3109041 ,-0.2518776 , 0.07074466, 0.06392946,-0.16754836,-0.09755849,  0.25724792, 0.42662862,-0.33947876,-0.20986493,-0.11870786,-0.12979442,  0.16214915, 0.03806734, 0.34591272, 0.4059539 ,-0.3627459 ,-0.07160053, -0.2469796 , 0.02878874,-0.22959729, 0.29746476, 0.01343361,-0.03259126, -0.00359755, 0.28563038,-0.00426055,-0.66343915, 0.09775496,-0.45316857,  0.23348805, 0.14599067,-0.46130165,-0.56067246, 0.3050187 ,-0.06473991,  0.16538218,-0.2808214 , 0.03526864, 0.19926982, 0.07056779,-0.30047888, -0.07910005,-0.69247204, 0.21968219, 0.34826538,-0.15716279,-0.5766157 , -0.266428  , 0.05289413,-0.1779128 ,-0.18061696, 0.16738924, 0.26949984, -0.00799224,-0.2453617 ,-0.10055971,-0.24695675;

		l1.bih << -0.10851542,-0.0214887 ,-0.0155663 ,-0.35718524, 0.24575882, 0.01896118,  0.2011414 , 0.15964143;

		l1.bhh << -0.27148047, 0.1916881 , 0.32005477,-0.2846713 ,-0.06862333,-0.1409422 ,  0.05876626,-0.03084346;

		l1.htn1 << 0.,0.,0.,0.,0.,0.,0.,0.;

		l2.Wih << -0.21643178,-0.38386196, 0.3036681 ,-0.32091236, 0.4484051 ,-0.03856007,  0.34649175, 0.20879222, 0.22629575,-0.5475757 , 0.14773124, 0.19684751,  0.40405032,-0.46514994, 0.27273348,-0.25305158, 0.03726481, 0.00461196,  0.24568875, 0.39309984,-0.17127828,-0.25166807,-0.4224823 , 0.22249249, -0.15466444,-0.4387554 , 0.36390743, 0.10368125, 0.54205334,-0.5532681 , -0.10578021, 0.15746678, 0.01407262, 0.30937368, 0.25996584, 0.17768376,  0.21049146,-0.0422914 , 0.07534931, 0.02669309,-0.07363138, 0.11926412,  0.22416031, 0.32390848,-0.11118529, 0.00534839, 0.06261007, 0.05275517, -0.20779935, 0.08566417,-0.26021928, 0.25493565, 0.3543943 , 0.08664548, -0.15869775, 0.2607164 , 0.14149533,-0.24935643, 0.41114044,-0.43014047,  0.17191055,-0.2349352 , 0.2988154 ,-0.13976666;

		l2.Whh <<  0.23417616, 0.3632597 ,-0.03112754, 0.1921634 , 0.19669262,-0.05904788, -0.20733413, 0.22446221,-0.2533247 ,-0.34638566,-0.12751345,-0.16926607, -0.02215992,-0.3557083 , 0.42030016, 0.13578853,-0.27649057, 0.0759356 ,  0.11418949,-0.0192163 ,-0.3446815 , 0.2840816 ,-0.03989686, 0.12186462,  0.08502643,-0.8430485 , 0.4747567 , 0.07797613,-0.3055621 , 0.49707496, -0.02878258, 0.2862735 , 0.08631574,-0.04416232,-0.00666245,-0.40006277, -0.15965395,-0.02948543, 0.06139494,-0.36801437, 0.28780407,-0.3245109 ,  0.12354099, 0.25683096,-0.31849304, 0.2548157 , 0.26434183,-0.0081387 , -0.27107418,-0.0449381 , 0.04477848,-0.05455851,-0.11750408, 0.25584933,  0.00523145,-0.25135195,-0.07957286,-0.07787248, 0.25626707, 0.24232122,  0.29782355, 0.24187075, 0.31089526, 0.21147104;

		l2.bih <<  0.18439652, 0.2538437 , 0.15247314,-0.16818348, 0.07659443,-0.25702167,  0.18833591, 0.37806177;

		l2.bhh << -0.2113574 ,-0.2417029 , 0.22646497,-0.26801914, 0.21613853, 0.2914809 , -0.12708634,-0.29470703;

		l2.htn1 << 0.,0.,0.,0.,0.,0.,0.,0.;

		l3.Wih << -0.23154524,-0.24264397,-0.11763494,-0.18534288, 0.29837513, 0.34911773, -0.11967824, 0.12242482, 0.10766995,-0.44686013,-0.3248748 , 0.16662173,  0.22086014,-0.20357019, 0.07684019,-0.4210555 ,-0.09158869, 0.1342247 ,  0.00832662,-0.09659643, 0.02150847, 0.07603148,-0.06012658, 0.0731873 ,  0.05331988,-0.07166315,-0.02791607, 0.20345142, 0.26387855,-0.23704158, -0.24444376, 0.03166   ,-0.31318668, 0.2529942 , 0.05115824,-0.10925931, -0.14987238,-0.22622481,-0.20407307,-0.12996994, 0.3462317 ,-0.21925347, -0.04383386,-0.36684126,-0.12393285,-0.06863045,-0.05614537, 0.336546  ,  0.31441325, 0.57985675,-0.26052138, 0.26771888, 0.13942565, 0.16901962, -0.0563118 , 0.07661588,-0.12499414, 0.04293004, 0.0968129 , 0.4002764 ,  0.10949355, 0.33634767, 0.3165325 ,-0.05738029;

		l3.Whh << -0.1321915 ,-0.02010238,-0.1783677 , 0.15964194, 0.37840387,-0.15455006,  0.06668979,-0.08471966, 0.24830993,-0.13491943,-0.2911472 , 0.01830369, -0.05124517, 0.04168411, 0.68257827, 0.10465072, 0.19835846,-0.09635706,  0.66466725, 0.489041  ,-0.3494464 ,-0.02307876, 0.17809522,-0.11866433, -0.06974824,-0.1708552 , 0.3408763 , 0.5468663 , 0.07107203,-0.3296875 ,  0.0256071 , 0.1703873 , 0.26622057,-0.33853927,-0.00541245,-0.00326889, -0.05788749,-0.4238291 , 0.33942953,-0.3324721 ,-0.16382164,-0.44902936, -0.07197833, 0.12264725,-0.41926697,-0.26081455, 0.23435089,-0.04160555,  0.40080097,-0.23709267, 0.22296743,-0.2077804 ,-0.11761421,-0.05629002, -0.12242908, 0.01085442, 0.00505083, 0.0891181 ,-0.12942092, 0.2803628 , -0.0749599 ,-0.17839523, 0.17789434,-0.26843598;

		l3.bih <<  0.17196815,-0.14196754,-0.10272766,-0.11592648,-0.32790604,-0.1243092 ,  0.15081511, 0.25958973;

		l3.bhh <<  0.07989087, 0.03113059,-0.05239939, 0.24051167, 0.24588938,-0.05399638, -0.02518273, 0.07305373;

		l3.htn1 << 0.,0.,0.,0.,0.,0.,0.,0.;

		f.A << -0.16457385,-0.1612815 ,-0.11863576, 0.20114553, 0.06580324,-0.06742146, -0.29766622, 0.08906934;
		f.b << -0.01566724;
	}

	void apply_model(T* x, T* y) {
		l0.apply_layer(*x);
		l1.apply_layer(l0.ht);
		l2.apply_layer(l1.ht);
		l3.apply_layer(l2.ht);
		*y=f.apply_layer(l3.ht);
	}
};