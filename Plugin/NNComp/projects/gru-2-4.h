/**
 * Autogenerated header file for gru-2-4
 * neural network model parameters.
 * 
 * Created on: 03/10/2022 at: 10:19
 * By Michael Holmes
*/

#pragma once
#include "layers.h"

template<typename T>
class Gru_2_4
{
public:
	const static int h = 2;
	const static int d = 1;
	const static int layers = 4;

	FccLayer<T, h, d> f;
	GruLayer<T, h, d> l0;
	GruLayer<T, h, h> l1;
	GruLayer<T, h, h> l2;
	GruLayer<T, h, h> l3;

	Gru_2_4() {
		l0.Wir << 0.73170173,1.8199013 ;
		l0.Wiz << -1.0353577, 3.093266 ;
		l0.Win <<  1.8550142,-1.281948 ;

		l0.Whr << -0.22158937, 0.9325604 , 0.46643233,-0.11142129;
		l0.Whz <<  0.6019074 ,-0.40411282, 1.4520558 ,-0.09348615;
		l0.Whn << -0.12353323,-0.0141798 , 1.1391097 ,-0.12159672;

		l0.bir << -0.65753174,-0.14724152;
		l0.biz << -0.55412924,-4.723791  ;
		l0.bin << -0.63187426, 0.37617028;

		l0.bhr << -0.01162874, 0.38682395;
		l0.bhz << -1.1480725,-4.9265094;
		l0.bhn <<  0.28657708,-0.66745263;

		l0.htn1 << 0.,0.;

		l1.Wir << -1.2510879, 1.7820867, 1.1093959,-2.5185828;
		l1.Wiz << -1.4426203,-1.1308622, 3.0357575,-5.0806985;
		l1.Win << -0.3619458 , 0.29371178, 0.7308175 ,-0.9404542 ;

		l1.Whr << -0.20564069,-0.19053678, 0.68833816, 0.03310451;
		l1.Whz <<  1.2258838,-0.7002915,-3.794309 ,-2.2817607;
		l1.Whn << -0.20105147, 1.4139984 , 1.4160128 , 0.9365788 ;

		l1.bir << -0.29669008, 0.3483027 ;
		l1.biz << -1.8096519, 2.2139506;
		l1.bin << -0.6086687 , 0.10024238;

		l1.bhr << -0.10334602,-0.04521582;
		l1.bhz << -1.5317484, 2.3256383;
		l1.bhn << 0.5689794 ,0.42432982;

		l1.htn1 << 0.,0.;

		l2.Wir <<  0.9711418,-1.0965059, 1.2748269,-0.8333272;
		l2.Wiz <<  2.5833511 ,-1.0176791 ,-0.5970022 , 0.38189897;
		l2.Win <<  1.9812739 ,-0.96994317, 0.39501327,-0.1971058 ;

		l2.Whr <<  1.4475766 , 0.1196266 ,-0.05349876,-0.30635884;
		l2.Whz <<  0.11916673,-1.208133  , 0.23860668, 0.6948071 ;
		l2.Whn << -0.61716515, 0.8117747 , 1.8710915 , 0.11275329;

		l2.bir << 0.08835533,0.71575266;
		l2.biz << -0.50698227, 2.6319563 ;
		l2.bin << 0.00061331,0.09797114;

		l2.bhr << 0.3342345 ,0.62599117;
		l2.bhz << -0.35967472, 2.2250881 ;
		l2.bhn << 0.3391896,0.4545959;

		l2.htn1 << 0.,0.;

		l3.Wir << -0.49244878,-1.172149  ,-1.1232188 , 0.7346976 ;
		l3.Wiz <<  9.734827 , 1.0713928, 2.2314696,-2.682722 ;
		l3.Win << -1.1680564 ,-0.87083507,-0.54275745, 0.4242437 ;

		l3.Whr << -0.5113078 ,-0.78087217,-0.85934675, 0.15582883;
		l3.Whz <<  1.0470897 , 0.09621185,-0.4187874 ,-0.72360516;
		l3.Whn <<  0.02035718,-0.16704595,-0.5432825 , 0.39746174;

		l3.bir <<  0.40642768,-0.19682623;
		l3.biz <<  2.35591 ,-4.942012;
		l3.bin << 0.24855141,0.08199765;

		l3.bhr <<  0.0916725 ,-0.17464751;
		l3.bhz <<  1.4739358,-4.863761 ;
		l3.bhn << 0.64099485,0.30651036;

		l3.htn1 << 0.,0.;

		f.A << -0.19534938,-0.66420937;
		f.b << 0.28236303;
	}

	void apply_model(T* x, T* y) {
		l0.apply_layer(*x);
		l1.apply_layer(l0.ht);
		l2.apply_layer(l1.ht);
		l3.apply_layer(l2.ht);
		*y=f.apply_layer(l3.ht);
	}
};