/**
 * Autogenerated header file for lstm-2-4
 * neural network model parameters.
 * 
 * Created on: 03/10/2022 at: 10:19
 * By Michael Holmes
*/

#pragma once
#include "layers.h"

template<typename T>
class Lstm_2_4
{
public:
	const static int h = 2;
	const static int d = 1;
	const static int layers = 4;

	FccLayer<T, h, d> f;
	LstmLayer<T, h, d> l0;
	LstmLayer<T, h, h> l1;
	LstmLayer<T, h, h> l2;
	LstmLayer<T, h, h> l3;

	Lstm_2_4() {
		l0.Wii <<  0.4873019,-1.930246 ;
		l0.Wif <<  0.0963292,-1.3617834;
		l0.Wig <<  0.02839015,-1.3692526 ;
		l0.Wio << 0.08856098,2.1963646 ;

		l0.Whi <<  0.6167676 ,-0.54479086,-1.59701   ,-5.6765814 ;
		l0.Whf << -1.0690172 , 0.6597747 ,-0.18023935,-0.5333781 ;
		l0.Whg <<  0.35445002, 0.43946123, 0.80346996,-0.55544716;
		l0.Who << -0.4710905 ,-0.36515072, 2.2558131 , 2.1776934 ;

		l0.bii << 0.42760998,0.12419552;
		l0.bif <<  0.69079983,-1.1051602 ;
		l0.big <<  0.54152095,-0.37610418;
		l0.bio << 0.57423526,1.0776724 ;

		l0.bhi << 0.00896905,0.53754205;
		l0.bhf << -0.04213507,-0.17213158;
		l0.bhg << -0.53412724, 0.33543006;
		l0.bho << 0.64706624,1.0917637 ;

		l0.htn1 << 0.,0.;
		l0.ctn1 << 0.,0.;

		l1.Wii <<  2.7313383 , 3.704998  , 1.0172937 ,-0.20211829;
		l1.Wif << -0.27500165,-0.4116335 , 1.4581541 , 1.2618043 ;
		l1.Wig <<  0.9107036,-1.3911035,-1.7879906, 2.029843 ;
		l1.Wio << 2.1478672 ,1.4082059 ,0.01711999,1.4624496 ;

		l1.Whi <<  1.6170198 ,-1.8830714 ,-2.792237  ,-0.11933728;
		l1.Whf << -0.6849247 , 0.36346897,-0.1787949 , 0.29197985;
		l1.Whg << -0.6594006 , 0.74251187,-0.2369538 ,-0.38361612;
		l1.Who << -0.55945706,-1.37564   ,-0.33743748,-1.8036622 ;

		l1.bii << 1.6098171 ,0.97639525;
		l1.bif << -0.3746351,-0.7470388;
		l1.big <<  0.45128113,-0.02142429;
		l1.bio << 2.4384975,2.8035777;

		l1.bhi << 2.1680229,1.902726 ;
		l1.bhf << -0.11745501, 0.46598172;
		l1.bhg << -0.4589658,-0.3315627;
		l1.bho << 1.8666264,2.5347443;

		l1.htn1 << 0.,0.;
		l1.ctn1 << 0.,0.;

		l2.Wii << -0.9665677,-0.6470147, 1.16947  ,-2.4347374;
		l2.Wif <<  0.09759601,-0.26632643, 0.46649295,-1.7459782 ;
		l2.Wig <<  2.5619297,-1.131221 , 1.6696538,-0.2519296;
		l2.Wio << -3.1678143, 0.3776204,-1.1235881,-1.212941 ;

		l2.Whi <<  1.0856302 , 0.7379418 , 1.1397052 ,-0.03042577;
		l2.Whf << -1.5454985 , 0.33765063,-0.07494338, 0.77713525;
		l2.Whg << -0.36083925,-0.2569857 ,-0.59951097, 0.0379585 ;
		l2.Who << 1.2798641,1.135335 ,0.9280324,1.1038852;

		l2.bii << 0.23091441,0.06219476;
		l2.bif << 0.03110192,1.0937507 ;
		l2.big << 0.0166029,0.352211 ;
		l2.bio << 0.27279267,0.4421526 ;

		l2.bhi << 0.9078282 ,0.02030868;
		l2.bhf << -0.20318817, 0.11520994;
		l2.bhg << -0.10314816,-0.20390227;
		l2.bho <<  1.2032677 ,-0.09710956;

		l2.htn1 << 0.,0.;
		l2.ctn1 << 0.,0.;

		l3.Wii <<  0.3603169 , 0.43497008,-0.17653555, 0.9228087 ;
		l3.Wif << -0.58470917, 0.66512555,-0.97890884,-0.11858483;
		l3.Wig << -0.25945833,-0.68757695, 1.2937835 ,-0.5377487 ;
		l3.Wio << 1.1002713 ,0.26266658,0.4141338 ,0.48019364;

		l3.Whi << -0.3383029 ,-0.32006967,-1.017279  , 0.02490882;
		l3.Whf << -1.6622751 , 0.35872048, 0.58828235,-0.02571088;
		l3.Whg << -0.37751555, 0.80540526, 0.27210802, 0.00376669;
		l3.Who << -0.47428256, 0.6471609 ,-0.59523463, 0.23999347;

		l3.bii << -0.3119278, 0.8871264;
		l3.bif << 0.8240442 ,0.47815305;
		l3.big << -0.1312027, 0.5317039;
		l3.bio << 0.65298086,0.34201103;

		l3.bhi << -0.33410498, 0.42311645;
		l3.bhf << -0.1482146 , 0.28736955;
		l3.bhg << -0.13997513, 0.4854995 ;
		l3.bho << 0.37092978,0.7602654 ;

		l3.htn1 << 0.,0.;
		l3.ctn1 << 0.,0.;

		f.A << -0.357076  , 0.45165426;
		f.b << -0.2845098;
	}

	void apply_model(T* x, T* y) {
		l0.apply_layer(*x);
		l1.apply_layer(l0.ht);
		l2.apply_layer(l1.ht);
		l3.apply_layer(l2.ht);
		*y=f.apply_layer(l3.ht);
	}
};