/**
 * Autogenerated header file for gru-4-4
 * neural network model parameters.
 * 
 * Created on: 03/10/2022 at: 10:19
 * By Michael Holmes
*/

#pragma once
#include "layers.h"

template<typename T>
class Gru_4_4
{
public:
	const static int h = 4;
	const static int d = 1;
	const static int layers = 4;

	FccLayer<T, h, d> f;
	GruLayer<T, h, d> l0;
	GruLayer<T, h, h> l1;
	GruLayer<T, h, h> l2;
	GruLayer<T, h, h> l3;

	Gru_4_4() {
		l0.Wir << -1.0174628 , 0.20717734, 4.1875134 ,-0.15309192;
		l0.Wiz <<  -0.5749636,  2.4617474,  1.8048645,-10.067118 ;
		l0.Win << -0.3046936, 1.0523466, 1.4080242,-0.8511566;

		l0.Whr << -0.00497816,-0.9913014 ,-0.20818746,-1.2279247 ,-0.5728063 ,-0.26736012,  0.12939622,-1.062598  ,-0.12333041, 0.15650524,-0.38544676, 0.04868117,  0.02578109,-0.29491457, 0.10580751,-1.3258333 ;
		l0.Whz << -1.7784958 ,-0.49874628, 1.0978067 , 0.8450482 ,-2.8516605 , 2.3924668 ,  0.21960919, 2.2862754 ,-0.8082135 ,-1.5258468 , 1.1079618 ,-2.3862948 ,  4.3283834 ,-2.5748816 ,-4.310978  ,-3.139211  ;
		l0.Whn << -0.33540174, 0.61663926, 0.8830939 ,-0.05102844, 0.20353696, 0.41459602, -0.28372228, 1.467792  ,-0.12034885, 0.32074884,-0.14155954, 0.9690499 , -0.02852967,-0.1165894 , 0.19637357, 1.1487799 ;

		l0.bir << -0.32391414, 0.21508726,-0.15028417, 0.27654386;
		l0.biz <<  0.1782312,-4.7823734,-2.1505425, 0.8945472;
		l0.bin << 0.17628637,0.28754005,0.04305131,0.247773  ;

		l0.bhr <<  0.2698735 ,-0.11761776, 0.20435216,-0.05233317;
		l0.bhz << -0.3004794 ,-4.9596663 ,-2.1181514 , 0.31464022;
		l0.bhn <<  0.7432255 ,-0.5354451 , 0.46440145,-0.49385998;

		l0.htn1 << 0.,0.,0.,0.;

		l1.Wir << -0.92566526,-0.86115485,-0.3170603 ,-0.9059549 ,-0.25953993, 0.2627743 ,  0.06761551,-0.20090099, 0.8139889 ,-0.26050746, 0.17946556,-0.33858716,  0.6749993 ,-0.8574713 ,-0.34467697,-0.7553538 ;
		l1.Wiz << -1.3344105 ,-1.9035095 ,-1.3141731 , 0.36822546, 1.1693333 , 0.20502248, -0.32060185, 1.0840545 , 2.2482567 ,-1.0869589 ,-0.4637613 ,-1.3117576 ,  0.05072731,-2.2254112 ,-5.5485883 ,-0.95410854;
		l1.Win <<  0.01878533, 0.3626592 , 0.95921797,-0.83412415,-0.40937132, 0.18789856, -0.26772237,-0.13059235,-0.41157347, 0.1840303 , 0.64927226,-0.7102377 ,  0.6831283 ,-0.11567075,-1.2676038 , 1.1839544 ;

		l1.Whr << -0.5128044 , 0.4139939 , 0.69019616,-0.07287131, 0.39306906, 0.51273376, -0.36321792,-0.00752513,-0.3200705 ,-1.206297  , 0.53919905, 0.3938958 ,  0.8314855 , 0.5017026 , 1.7008898 , 0.20359017;
		l1.Whz <<  1.2196916 ,-2.0927114 ,-0.6975859 , 1.5297765 , 0.8720376 , 3.1210868 , -0.73821884,-2.3949687 , 0.27146137,-0.1471845 , 0.6409332 , 0.6784897 ,  0.18903786,-0.6854438 , 2.6579142 ,-1.3259119 ;
		l1.Whn << -0.31572485,-0.04390639,-0.40688023, 0.47252664,-0.4648114 , 0.35281408, -0.5759185 , 0.6880406 , 0.71077186,-1.1999785 , 0.62115026, 0.03041034,  0.39864528, 0.02842808, 0.11750589, 0.43691897;

		l1.bir << -0.11814636, 0.38877636,-0.04494802,-0.49243623;
		l1.biz << -1.4620566 , 0.4741306 , 1.6700374 , 0.78118366;
		l1.bin << -0.36585858, 0.1485934 , 0.23445272, 0.06864896;

		l1.bhr << -0.04229663,-0.29269698, 0.39028475, 0.22714162;
		l1.bhz << -1.6750469 ,-0.13210112, 1.544614  , 0.12605283;
		l1.bhn <<  0.07110404, 0.12084483,-0.14285345, 0.24696682;

		l1.htn1 << 0.,0.,0.,0.;

		l2.Wir <<  0.6569797 ,-1.4410545 , 0.9485761 ,-0.8188581 , 0.9073642 , 0.7762805 , -0.30571353,-0.22924788, 0.142834  ,-0.09873353, 0.26541662,-0.20196912, -0.3193399 ,-0.12537588, 0.61424744, 0.28145796;
		l2.Wiz <<  0.4056287 ,-0.16507283,-0.757352  ,-2.2139702 , 2.2132547 , 3.7310603 ,  0.4291701 , 0.8492616 , 1.0059642 , 0.84595555,-0.34341142,-1.3868129 , -1.4744413 ,-1.7344815 ,-1.672837  , 1.9968678 ;
		l2.Win <<  1.025191  ,-0.25178325, 0.7388501 ,-1.0932792 , 0.27148515, 0.5394441 , -0.09149153,-0.15508404,-0.60827774,-0.42383015, 0.47090587,-0.37998587,  0.42485857, 0.38764444,-0.48890287,-0.8416764 ;

		l2.Whr <<  0.6664858 ,-0.4762169 , 0.376112  ,-0.26543313, 0.17605552, 0.64524496, -0.43788475, 0.81284285,-0.22191633,-0.1955836 ,-0.13667424,-0.60763323, -0.61090183, 0.11146522, 0.02286129,-0.34078464;
		l2.Whz << -1.2563869 , 0.25044212,-1.146421  , 0.7629143 ,-0.57513803,-3.1424088 ,  1.8110961 ,-1.1356161 , 0.13465236,-3.2477834 , 1.449632  ,-1.061285  , -0.47530285,-0.29243582,-0.9475841 , 1.8454046 ;
		l2.Whn << -0.03335194,-0.2694188 ,-0.32794094,-0.02802499,-0.6707971 , 0.18219376,  0.10044554,-0.6826203 ,-0.03582017, 0.08792848, 0.05094294, 0.18832797,  0.01564037,-0.2676345 ,-0.12472231,-0.2004669 ;

		l2.bir << -0.05030908,-0.15869395,-0.21550056,-0.23562491;
		l2.biz << -0.12872323,-0.8344642 ,-1.4499717 , 0.05972144;
		l2.bin << 0.05968416,0.04026963,0.00140473,0.4428002 ;

		l2.bhr << -0.19436258,-0.02408131, 0.17998633, 0.08071151;
		l2.bhz <<  0.27351218,-1.044119  ,-1.8066665 ,-0.52123845;
		l2.bhn <<  0.10787399, 0.23512614,-0.41548273,-0.3736804 ;

		l2.htn1 << 0.,0.,0.,0.;

		l3.Wir << -0.9768311 ,-0.5104097 , 0.32602015,-0.44310448, 1.6291212 ,-0.5541421 ,  0.752578  , 0.40901646, 0.04983525,-0.89275527, 0.7231681 ,-0.7229029 ,  0.67285866,-0.38386402,-0.36641973,-0.287086  ;
		l3.Wiz <<  0.28009433, 2.0199177 ,-1.0530841 , 1.6847854 ,-4.141548  ,-1.6405207 ,  1.7416856 ,-3.0308132 ,-1.4487581 ,-2.0684614 , 1.4021384 ,-3.1370714 , -2.702146  ,-2.360656  , 2.617509  ,-3.8319457 ;
		l3.Win << -0.42811775,-0.8222731 , 0.27272272, 0.47548446,-0.23020929,-0.524625  ,  0.02198713, 0.1882763 , 0.6350405 , 0.6011843 ,-0.6399169 , 0.35964853,  0.3420525 ,-0.06070032,-0.19223878, 0.50494677;

		l3.Whr <<  0.29735327,-0.42259976, 0.11358167,-0.5028708 ,-0.16707925,-0.5948312 ,  0.7842603 , 0.80878913,-0.6084316 ,-0.23440292,-0.03517715,-0.46526462, -0.21015562, 0.42567238, 0.39442417,-0.25403005;
		l3.Whz << -0.7100691, 1.0346416,-1.0855154,-1.1470662,-3.9921653, 5.559216 , -4.391915 ,-4.835831 ,-5.414284 , 4.424119 ,-3.7664204,-3.973428 , -3.485187 , 4.2049813,-3.6123264,-3.6767416;
		l3.Whn << -0.39815786,-0.02334607, 0.20767638, 0.07398664, 0.2129677 ,-0.20005722, -0.34942597,-0.5385925 ,-0.05297183,-0.05779589, 0.14945497, 0.13366874,  0.44332296,-0.27028245, 0.33735466, 0.503653  ;

		l3.bir << -0.21138401,-0.13280943, 0.01230286,-0.47837165;
		l3.biz << -0.78437716,-3.3938458 ,-3.8063028 ,-3.5729399 ;
		l3.bin <<  0.03960022,-0.4518056 , 0.5261004 , 0.28729773;

		l3.bhr << -0.30570212,-0.4621571 ,-0.74902767,-0.06485479;
		l3.bhz << -0.08726117,-2.7578938 ,-3.766388  ,-3.9843514 ;
		l3.bhn <<  0.4132729 , 0.29086876,-0.2601275 ,-0.10032684;

		l3.htn1 << 0.,0.,0.,0.;

		f.A <<  0.2675774 , 0.10134018,-0.46924585,-0.29429603;
		f.b << 0.4023674;
	}

	void apply_model(T* x, T* y) {
		l0.apply_layer(*x);
		l1.apply_layer(l0.ht);
		l2.apply_layer(l1.ht);
		l3.apply_layer(l2.ht);
		*y=f.apply_layer(l3.ht);
	}
};