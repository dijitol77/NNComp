/**
 * Autogenerated header file for gru-4-2
 * neural network model parameters.
 * 
 * Created on: 03/10/2022 at: 10:19
 * By Michael Holmes
*/

#pragma once
#include "layers.h"

template<typename T>
class Gru_4_2
{
public:
	const static int h = 4;
	const static int d = 1;
	const static int layers = 2;

	FccLayer<T, h, d> f;
	GruLayer<T, h, d> l0;
	GruLayer<T, h, h> l1;

	Gru_4_2() {
		l0.Wir << -1.8892064, 4.816038 ,-1.9469038,-3.5019228;
		l0.Wiz << -1.9703698,-1.486663 , 2.0468755, 1.2649411;
		l0.Win << -0.6313784 ,-1.8038576 ,-1.0313373 ,-0.21424322;

		l0.Whr <<  1.0303286 , 0.3676675 , 0.17947403, 0.36989042,-0.27329132,-0.30152887, -0.21411982,-1.5069596 , 1.4677653 ,-0.64528024,-0.5372045 , 1.0198675 ,  1.5116222 , 2.0723057 , 0.5968069 ,-0.7155495 ;
		l0.Whz <<  1.2638156 , 0.62026346,-1.7868026 , 1.8356872 ,-0.20343697, 0.49933547, -1.5651536 , 1.6822957 , 3.7945426 ,-0.01338859, 3.5514743 , 0.42271596, -3.8245218 ,-7.951433  ,-1.9903951 , 5.7272253 ;
		l0.Whn << -0.33940825,-0.82459474,-1.3929073 ,-0.78181845,-1.5559025 , 0.7982975 ,  0.09175936, 1.1341794 , 0.95192975,-1.035241  ,-0.8137567 , 0.48904288,  0.3434563 , 1.10053   , 0.9551323 ,-0.25439137;

		l0.bir << -0.27978557, 0.04414757,-0.34861594, 0.35145545;
		l0.biz << -0.9085201,-1.9907523,-0.7264853, 2.6799095;
		l0.bin << -0.2953279 , 0.06283432,-0.33047116, 0.21384859;

		l0.bhr << -0.30096903,-0.34555307,-0.939101  , 0.5628611 ;
		l0.bhz << -0.9779821,-1.8345214,-1.0401769, 2.7561352;
		l0.bhn <<  0.24555911,-0.60312325,-0.1931712 , 0.13687816;

		l0.htn1 << 0.,0.,0.,0.;

		l1.Wir << -0.27199122,-1.333561  , 0.17300224, 0.3889428 ,-0.88803303,-0.64999294, -0.6237047 , 0.26393113,-0.44894138, 0.75531405, 0.18865101,-0.09519161,  3.7011552 , 0.6007876 , 1.0050408 ,-0.12053498;
		l1.Wiz <<  0.8532494 ,-0.01733788,-0.2881158 , 1.3215739 , 3.833003  ,-0.24625067, -0.60189015,-0.7901541 ,-0.61514467,-2.517455  ,-0.9163626 , 1.3934046 ,  3.3834841 ,-0.02565162, 0.20059562, 1.0205101 ;
		l1.Win <<  0.68023264, 0.50379246, 0.7553532 , 0.15753603,-0.03310113,-0.27118436, -0.21138106,-0.11748099, 0.4369494 , 0.36454   , 0.10902438, 0.08455969, -0.8878362 ,-0.27316   ,-0.88128084, 0.66926783;

		l1.Whr << -0.53526235, 0.08646713,-0.3507848 ,-0.02524023, 0.6761772 ,-0.13723373, -0.0034739 , 0.66566676,-0.30390382,-0.30577672, 0.10031111,-0.15563107,  0.18871225, 0.7241481 ,-0.0086395 , 0.8283742 ;
		l1.Whz << -0.09107835,-0.11754003,-1.3636957 ,-0.26542002, 1.4220399 ,-2.3923736 , -0.5069503 ,-2.3255937 , 0.28882334,-1.6907469 ,-2.0294502 , 2.1627214 ,  0.30179307,-1.7736142 , 0.28124768,-0.4788724 ;
		l1.Whn <<  0.7492124 ,-0.0049408 ,-0.12982842,-0.7924804 , 0.15242496, 0.3217044 , -0.09154039,-0.9144151 , 0.6917805 , 0.1722025 ,-0.12519021, 0.14430971, -0.345637  ,-0.33980128, 0.3325344 , 1.0608985 ;

		l1.bir <<  0.34738314, 0.08637748, 0.7271475 ,-0.03642037;
		l1.biz <<  1.5787766 ,-0.17379205,-1.0531198 ,-0.11848816;
		l1.bin <<  0.47095892,-0.22575845,-0.5699371 ,-0.08539335;

		l1.bhr << -0.3210752 ,-0.06498698,-0.20476155,-0.03158049;
		l1.bhz <<  2.2635267 ,-0.06160586,-0.71094406,-0.1758989 ;
		l1.bhn << -0.27020097, 0.34844378,-0.5921277 ,-0.24239957;

		l1.htn1 << 0.,0.,0.,0.;

		f.A <<  0.17608471, 0.37994152,-0.33145112, 0.44371623;
		f.b << -0.32140473;
	}

	void apply_model(T* x, T* y) {
		l0.apply_layer(*x);
		l1.apply_layer(l0.ht);
		*y=f.apply_layer(l1.ht);
	}
};