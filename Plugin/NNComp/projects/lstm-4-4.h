/**
 * Autogenerated header file for lstm-4-4
 * neural network model parameters.
 * 
 * Created on: 03/10/2022 at: 10:19
 * By Michael Holmes
*/

#pragma once
#include "layers.h"

template<typename T>
class Lstm_4_4
{
public:
	const static int h = 4;
	const static int d = 1;
	const static int layers = 4;

	FccLayer<T, h, d> f;
	LstmLayer<T, h, d> l0;
	LstmLayer<T, h, h> l1;
	LstmLayer<T, h, h> l2;
	LstmLayer<T, h, h> l3;

	Lstm_4_4() {
		l0.Wii << -1.696957  ,-0.5955281 ,-0.32794368, 0.00383047;
		l0.Wif << -2.5160663 ,-0.51905197,-0.8460693 , 0.34745982;
		l0.Wig <<  1.0271614 ,-0.52332664, 1.0663544 ,-0.15971507;
		l0.Wio << -0.6263864 ,-1.5141512 ,-0.34556863, 0.60728145;

		l0.Whi << -1.199192  ,-1.3359219 ,-0.89498067,-0.717004  , 0.64427036,-0.04497708,  0.04664506, 0.11513789, 0.42781818,-0.42984805, 0.02369204,-0.44586775, -0.27535862, 0.05418935,-0.5612838 , 0.02350156;
		l0.Whf <<  0.7410898 , 0.8078416 , 0.24203005, 0.6549069 , 0.57971686, 0.17925292, -0.4432043 , 0.02321647, 0.37179908, 0.21944273, 0.23493686,-0.29075065, -0.61234665,-0.5820435 ,-0.18161067,-0.5618281 ;
		l0.Whg << -0.19286837,-0.0461145 ,-0.3900861 ,-0.15989791, 0.00699455,-0.14778905,  0.1290071 ,-0.07539758, 0.29514748,-0.09371039, 0.21528701,-0.24646804,  0.4100658 ,-0.42097262, 0.09997152, 0.00932907;
		l0.Who << -0.11947297,-0.66016656,-1.1043686 ,-1.4371074 , 0.01948305, 0.31746328, -0.18346047,-0.37067032, 0.24419232,-0.4979451 , 0.04429618, 0.19470699, -1.1799229 ,-0.00907887,-0.4999329 ,-0.20672934;

		l0.bii << 1.1713003 ,0.25188226,0.3969329 ,0.19639781;
		l0.bif << -0.6158663 , 0.2499733 , 0.10312617, 0.51568633;
		l0.big << -0.22511724,-0.39286917,-0.35696834,-0.31127384;
		l0.bio <<  0.53433883,-0.08396024, 0.6726334 , 0.14156032;

		l0.bhi <<  1.1211631 , 0.21062383,-0.0251543 , 0.0223197 ;
		l0.bhf << -0.6633689, 0.326718 , 0.2046025, 0.0089856;
		l0.bhg << -0.21032658,-0.4807629 ,-0.4053663 ,-0.22490339;
		l0.bho <<  0.56018084, 0.14312154,-0.10776085, 0.49521255;

		l0.htn1 << 0.,0.,0.,0.;
		l0.ctn1 << 0.,0.,0.,0.;

		l1.Wii << -0.02517993,-0.7401389 ,-0.59589416,-0.7873249 , 0.24718906, 0.05743552,  0.22901979, 0.00519306,-0.41547355,-0.7918825 ,-0.71771955,-0.5209433 ,  0.33847165, 0.17276041, 0.40134642, 0.91415364;
		l1.Wif << -0.00739662,-0.0240856 ,-0.12550385, 0.9316102 , 0.14427777,-0.5452504 , -0.23377784, 0.13806385,-0.05676574,-0.09842685, 0.09365167, 0.19227013, -1.1539274 , 0.16928747,-0.61030346, 0.35300267;
		l1.Wig <<  1.2690202 , 0.31963393,-0.19856139,-0.43384698, 0.32209754,-0.49198574,  0.35033622, 0.05135982, 0.98166436, 0.69067144, 0.4523732 ,-0.53637344,  0.46085715,-0.3118141 ,-0.14046127, 0.21970463;
		l1.Wio << -1.0584759 ,-0.5496032 ,-0.62713224,-0.34130648,-0.54122525, 0.19867785, -0.22468932, 0.42821652, 0.2911231 ,-0.5681841 ,-0.29191726,-0.52805996, -1.4282174 , 0.04203722,-0.17452914, 0.02941724;

		l1.Whi <<  0.65258497,-0.6702453 ,-0.1102521 , 0.8155532 ,-0.0479097 ,-0.5214753 , -0.8278201 ,-0.20518792,-1.239945  ,-0.33082366,-0.7258851 , 1.0796026 ,  0.45144928, 0.7809761 , 0.98217237,-0.02814513;
		l1.Whf <<  0.5199015 , 0.05101972, 0.48611057, 0.51566344, 0.16116166,-0.53533405, -0.6249413 , 0.32097706, 0.13917933, 0.389276  ,-0.47013634, 0.44210085, -1.4989047 ,-0.40836847, 1.3841201 , 0.56551343;
		l1.Whg << -0.4195427 ,-0.2948759 ,-0.5973513 , 0.34141657,-0.51349574, 0.48904535,  0.7468924 , 0.22364613,-0.35852098,-0.28044724, 0.10846808,-0.04345619, -0.14274916, 0.67612636,-0.8314748 , 0.4889061 ;
		l1.Who << -0.6431034 ,-0.79435223, 0.232862  , 0.8330773 ,-0.15083039,-0.2560657 , -0.06821864, 0.03026248,-0.12131026,-1.009354  ,-1.5489444 , 1.4907144 , -1.2241882 ,-0.41639853, 0.15901445, 0.28738955;

		l1.bii <<  1.0899136 , 0.16628225, 0.0585032 ,-0.5201555 ;
		l1.bif << -0.6536816 ,-0.01603339,-0.3239331 , 0.55964994;
		l1.big << -0.30675986,-0.31835562, 0.37749976, 0.37858212;
		l1.bio <<  0.9045818 ,-0.19028774, 0.3195293 ,-0.13803993;

		l1.bhi << 0.54044217,0.44616315,0.3758326 ,0.1189954 ;
		l1.bhf <<  0.07688147,-0.12699251, 0.37036717, 0.28222677;
		l1.bhg << -0.2510557 ,-0.3588056 , 0.04640213,-0.10768756;
		l1.bho <<  1.3207582 ,-0.2051922 , 0.22931738, 0.5715768 ;

		l1.htn1 << 0.,0.,0.,0.;
		l1.ctn1 << 0.,0.,0.,0.;

		l2.Wii <<  0.6040187 , 0.05379336, 0.5811086 , 0.6008175 , 0.03620772,-0.29710448, -0.85095835, 0.6486576 , 0.06828269, 0.7769987 ,-1.011249  , 1.1785563 ,  0.03368271, 0.06417257, 0.7690144 , 0.32891685;
		l2.Wif <<  0.0106111 ,-0.72597456, 0.2915589 , 0.49952602, 0.8310489 ,-0.21384348, -0.22679587,-0.12075736, 0.5146074 , 0.7788735 , 0.82437533, 0.5131086 ,  0.12371852, 0.61286134, 1.0490855 ,-0.14584489;
		l2.Wig <<  0.10575638, 0.40022147,-0.10219736, 0.56520236,-0.09328454, 0.32751763, -0.18562348,-0.05533119,-1.0347921 ,-0.07398346,-0.9368971 ,-0.01260726,  0.20190017,-0.19728297, 0.088672  ,-0.06009484;
		l2.Wio << -0.5764969 ,-0.7095544 ,-0.00543697, 0.16794744,-0.31789178,-0.1602802 , -0.35404667, 0.21861537, 0.21832466, 1.0284464 ,-0.836807  , 0.8956533 ,  0.679079  , 0.3176024 , 0.42462912,-0.09020284;

		l2.Whi << -0.12817931,-0.16970402,-0.39339352,-0.14623496,-0.34730184, 0.39684775,  0.20014147, 0.3905066 , 0.78549844,-1.0242133 ,-1.4129218 , 1.3521032 ,  0.33869654,-0.44903216,-0.6289643 , 0.5471139 ;
		l2.Whf <<  0.37647563,-0.2005584 ,-0.6459297 ,-0.17391302,-0.0938024 ,-0.08254894, -0.13579467,-0.16538557,-0.03789119,-0.52926314,-0.17489484,-0.47205064, -0.3607161 , 0.18334138,-0.39569268, 0.02604279;
		l2.Whg <<  0.12720221, 0.01306724,-0.13769391, 0.13291362,-0.39155197, 0.37903678,  0.9579035 ,-0.501357  , 0.19941923, 0.04413157,-0.3988403 ,-0.12385909,  0.5655782 , 0.04071789,-0.21706778, 0.00979242;
		l2.Who << -0.12141238,-0.6003676 ,-0.5679691 , 0.31478593, 0.12283005,-0.33947372,  0.12161644,-0.21199544, 1.0343066 ,-1.0576098 ,-1.5879203 , 0.6894382 ,  0.22356497, 0.09806451,-0.14334331,-0.04656485;

		l2.bii <<  0.54547065, 0.21280248,-0.17191796,-0.19155009;
		l2.bif <<  0.36318713,-0.06450929,-0.767917  , 0.00251531;
		l2.big << -0.15994483, 0.3151331 ,-0.1397319 ,-0.36250898;
		l2.bio << 0.485917  ,0.5104196 ,0.31917313,0.02708564;

		l2.bhi << -0.27319252, 0.19167642, 0.2989829 , 0.297075  ;
		l2.bhf <<  1.8165085e-01, 2.4372935e-01,-7.0965005e-05, 5.4360020e-01;
		l2.bhg <<  0.21983112,-0.32499367,-0.10985409, 0.3747616 ;
		l2.bho <<  0.5750085 ,-0.12371989, 0.8012097 , 0.11069205;

		l2.htn1 << 0.,0.,0.,0.;
		l2.ctn1 << 0.,0.,0.,0.;

		l3.Wii <<  0.33466035,-0.26674116, 0.27978447,-0.17386785, 0.25436476, 0.22357544, -1.0434169 , 0.5741696 , 0.52617604,-0.46886262, 0.69886035, 0.22254416,  1.0864664 ,-0.20157424,-0.11482176, 1.2438867 ;
		l3.Wif <<  3.7725374e-01, 1.6285740e-01,-5.0265159e-02, 4.4044223e-01,  5.8415395e-01,-1.6659224e-01,-1.9966210e+00, 2.9750818e-01, -1.1702828e-01, 1.0261226e-03, 7.6803595e-01,-3.0474988e-01,  2.4354601e-01, 2.1938048e-01,-4.3089786e-01,-3.1759953e-01;
		l3.Wig <<  0.25337765,-0.13181952,-0.6875357 ,-0.18692344,-0.47168982, 0.41201502, -0.11983944,-0.48764515, 0.31683326, 0.06755485,-0.41263992,-0.11644033,  0.17949219,-0.30445293, 1.1240798 ,-0.37207124;
		l3.Wio <<  0.23020336, 0.10784107, 0.8620637 ,-0.5299013 ,-0.05790826,-0.25095084, -1.2369527 , 0.5880873 ,-0.28464243, 0.04193278, 0.7603742 ,-0.41717744,  1.0414183 ,-0.5725703 ,-0.44813845, 1.3008691 ;

		l3.Whi << -0.06229938, 0.12712842, 0.33894876,-0.18714827, 0.32961464,-0.8139    , -0.14032598,-0.17570998, 0.11535155, 0.2095083 ,-0.1503462 , 0.4005608 , -0.4185504 ,-1.5824805 , 0.03807342, 0.42129254;
		l3.Whf <<  0.5239435 , 0.1972731 , 0.47514373, 0.20659097, 0.22909042,-0.36813954, -0.2661948 ,-0.58698666,-0.10005395, 0.03327328, 0.38193694, 0.31021133,  0.49255434,-0.6908701 ,-0.14554085, 0.28963202;
		l3.Whg <<  0.4832313 ,-0.00703509,-0.4933364 ,-0.29057178, 0.12810287, 0.09750725,  0.49493873,-0.5130646 ,-0.1612016 ,-0.5366689 , 0.09593812, 0.14084747, -0.44352508,-0.12476005, 0.08371579,-0.06852145;
		l3.Who <<  0.46931666,-0.40718406, 0.03981202,-0.7933576 , 0.49058053, 0.11196101,  0.24411213,-2.0667393 , 0.32553536,-0.15194248,-0.26447544,-0.3154404 , -0.31170145,-1.3705168 , 0.0323096 ,-0.9824826 ;

		l3.bii << -0.23077704,-0.38230622, 0.22166549, 0.5214327 ;
		l3.bif << -0.42300314, 0.42677727, 0.15203676,-0.6890067 ;
		l3.big << -0.43438524,-0.2800971 ,-0.16102271, 0.25585648;
		l3.bio <<  0.29776984,-0.14689519, 0.38500085, 0.28521588;

		l3.bhi <<  0.27286854,-0.12865366, 0.31765264, 0.62872726;
		l3.bhf <<  0.03028786, 0.02100584, 0.04547494,-0.06965833;
		l3.bhg << -0.18150973, 0.4861466 , 0.4078682 ,-0.47202018;
		l3.bho << -0.07705961, 0.28404444,-0.08263801, 0.66747326;

		l3.htn1 << 0.,0.,0.,0.;
		l3.ctn1 << 0.,0.,0.,0.;

		f.A << -0.26123944, 0.26285827, 0.26897666, 1.0302578 ;
		f.b << -0.06779221;
	}

	void apply_model(T* x, T* y) {
		l0.apply_layer(*x);
		l1.apply_layer(l0.ht);
		l2.apply_layer(l1.ht);
		l3.apply_layer(l2.ht);
		*y=f.apply_layer(l3.ht);
	}
};